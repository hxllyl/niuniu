<div class="row first">
  <div class="form-group col-md-6">
    <label for="car_standard" class="col-md-4 control-label">规格</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[standard_id]" class="form-control input-sm" id="post_standard_id", data-url=<%= get_select_infos_user_my_posts_path(current_user.id)%>>
          <%- @standards.each do |standard| %>
          <option value="<%= standard.id %>"><%= standard[:name]%></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
  <div class="form-group col-md-6">
    <label for="car_brand" class="col-md-4 control-label">品牌</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[brand_id]" class="form-control input-sm" id="post_brand_id", data-url=<%= get_select_infos_user_my_posts_path(current_user.id)%> >
          <%- @brands.each do |brand| %>
          <option value="<%= brand.id %>"><%= brand.name %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="form-group col-md-6">
    <label for="car_model" class="col-md-4 control-label">车型</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[car_model_id]" class="form-control input-sm" id="post_car_model_id", data-url=<%= get_select_infos_user_my_posts_path(current_user.id)%>>
          <%- @car_models.each do |car_model| %>
            <option value="<%= car_model.id %>"><%= car_model.name %></option>
          <% end %>
          <option value="set_car_model">自定义</option>
        </select>
      </div>
    </div>
  </div>
  <div class="form-group col-md-6">
    <label for="car_style" class="col-md-4 control-label">款式</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[base_car_id]" class="form-control input-sm" id="post_base_car_id", data-url=<%= get_select_infos_user_my_posts_path(current_user.id)%>>
          <%- @base_cars.each do |base_car| %>
            <option value="<%= base_car.id %>"><%= base_car.style %></option>
          <% end %>
          <option value="set_base_car">自定义</option>
        </select>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="form-group col-md-6">
    <label for="car_appearance" class="col-md-4 control-label">外观</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[outer_color]" class="form-control input-sm" id="car_appearance">
          <%- @base_car.outer_color.each do |ele| %>
            <option value="<%= ele %>"><%= ele %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
  <div class="form-group col-md-6">
    <label for="car_interior" class="col-md-4 control-label">内饰</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[inner_color]" class="form-control input-sm" id="car_interior">
          <%- @base_car.inner_color.each do |ele| %>
            <option value="<%= ele %>"><%= ele %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="form-group col-md-6">
    <label for="car_address" class="col-md-4 control-label">上牌地点</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <input type="text" class="form-control input-sm" name="post[car_license_areas]">
      </div>
    </div>
  </div>
  <div class="form-group col-md-6">
    <label for="car_area" class="col-md-4 control-label">区域要求</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[car_in_areas]" class="form-control input-sm" id="car_area">
          <%- @brand.regions.each do |ele| %>
            <option value="<%= ele %>"><%= ele %></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="form-group col-md-6">
    <label for="car_date" class="col-md-4 control-label">提车时间</label>
    <div class="col-md-9 inputBox">
      <div class="dropdown w100p">
        <select name="post[take_car_date]" class="form-control input-sm" id="car_date">
          <%- Post::TAKE_DATES.each do |k, v|%>
            <option value="<%= k %>"><%= v%></option>
          <% end %>
        </select>
      </div>
    </div>
  </div>
</div>
<div class="methodSelect row">
  <div class="tt clearfix">
    <h5 class="col-md-6">报价方式</h5>
    <h5 class="col-md-6">指导价：<span id="guidePrice"><%= @base_car.base_price.to_f %></span>万</h5>
  </div>
  <div class="form-group form-inline col-md-6">
    <label class="radio selectTag">
      <input type="radio" name="post[discount_way]" id="methodRadios1" value="1"><span>优惠点数</span>
    </label>
    <label class="selectInput">
      <input type="text" class="form-control input-sm" id="methodVal1" placeholder="" name="post[discount_content]">
      <div class="units">点数</div>
    </label>
  </div>
  <div class="form-group form-inline col-md-6">
    <label class="radio selectTag">
      <input type="radio" name="post[discount_way]" id="methodRadios2" value="2"><span>优惠金额</span>
    </label>
    <label class="selectInput">
      <input type="text" class="form-control input-sm" id="methodVal2" placeholder="" name="post[discount_content]">
      <div class="units">万元</div>
    </label>
  </div>
  <div class="form-group form-inline col-md-6">
    <label class="radio selectTag">
      <input type="radio" name="post[discount_way]" id="methodRadios3" value="3"><span>加价金额</span>
    </label>
    <label class="selectInput">
      <input type="text" class="form-control input-sm" id="methodVal3" placeholder="" name="post[discount_content]">
      <div class="units">万元</div>
    </label>
  </div>
  <div class="form-group form-inline col-md-6">
    <label class="radio selectTag">
      <input type="radio" name="post[discount_way]" id="methodRadios4" value="4"><span>直接报价</span>
    </label>
    <label class="selectInput">
      <input type="text" class="form-control input-sm" id="methodVal4" placeholder="" name="post[discount_content]">
      <div class="units">万元</div>
    </label>
  </div>
</div>

<script type="text/javascript">
$(document).ready(function(){
  $('body').on('change', '#post_standard_id', function(){
    var url = $(this).data('url');
    var standard_id = $('#post_standard_id').val();

    $.ajax({
      method: "GET",
      url: url,
      data: {
        post: {
          standard_id: standard_id
        }
      },
      success: function(data){
        console.log('data')
        $("#form_select").html(data)
      }
    });
  });

  $('body').on('change', '#post_brand_id', function(){
    var url = $(this).data('url');
    var standard_id = $('#post_standard_id').val();
    var brand_id = $('#post_brand_id').val();

    $.ajax({
      method: "GET",
      url: url,
      data: {
        post: {
          standard_id: standard_id,
          brand_id: brand_id
        }
      },
      success: function(data){
        console.log('data')
        $("#form_select").html(data)
      }
    });
  });

  $('body').on('change', '#post_car_model_id', function(){
    var url = $(this).data('url');
    var standard_id = $('#post_standard_id').val();
    var brand_id = $('#post_brand_id').val();
    var car_model_id = $('#post_car_model_id').val();

    $.ajax({
      method: "GET",
      url: url,
      data: {
        post: {
          standard_id: standard_id,
          brand_id: brand_id,
          car_model_id: car_model_id
        }
      },
      success: function(data){
        console.log('data')
        $("#form_select").html(data)
      }
    });
  });

  $('body').on('change', '#post_base_car_id', function(){
    var url = $(this).data('url');
    var standard_id = $('#post_standard_id').val();
    var brand_id = $('#post_brand_id').val();
    var car_model_id = $('#post_car_model_id').val();
    var base_car_id = $('#post_base_car_id').val();

    $.ajax({
      method: "GET",
      url: url,
      data: {
        post: {
          standard_id: standard_id,
          brand_id: brand_id,
          car_model_id: car_model_id,
          base_car_id: bae_car_id
        }
      },
      success: function(data){
        console.log('data')
        $("#form_select").html(data)
      }
    });
  });

  $(".selectInput").find("input.form-control").attr("disabled","true");
  $(".methodSelect > .form-group").find(".selectTag").click(function (e) {
    if ($(this).hasClass("disabled")) return false;
    $(".selectInput").find("input.form-control").attr("disabled","true");
    $(this).next(".selectInput").find("input.form-control").removeAttr("disabled");
    $(".selectInput").removeClass("active");
    $(".methodSelect > .form-group").find(".selectTag").removeClass("active");
    $(this).addClass("active").siblings().removeClass("active");
    $(this).next(".selectInput").addClass("active").focus();
  });

  $(".selectInput").find("input.form-control").keyup(function(){
    clearNoNum(this);
  });
});

function clearNoNum(obj){
  obj.value = obj.value.replace(/[^\d.]/g,""); //清除"数字"和"."以外的字符
  obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,'$1$2.$3'); //只能输入两个小数
}
</script>
